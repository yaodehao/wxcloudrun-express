<template><div><br>&nbsp;	<br><v-card max-width="450" class="mx-auto"  color="green lighten-3" ><v-card-text><v-sheet  class="v-sheet--offset mx-auto"   :color="d_attr.tbcolor"  elevation="5"   max-width="calc(100% - 32px)"><v-sparkline height="130px" auto-draw :value="value" :labels="labels"  :smooth="radius || false"  :line-width="type!=='bar' ? 1:10 "  :fill="fill" :type="type"  :label-size="labelSize" padding="12" color="white"></v-sparkline></v-sheet></v-card-text> <v-toolbar :color="d_attr.tbcolor" dark dense> <v-toolbar-title>{{d_attr.title}}{{chartdata}}</v-toolbar-title> <v-spacer></v-spacer>        <v-menu bottom left>        <template v-slot:activator="{ on }"><v-btn icon  v-on="on" ><v-icon>mdi-invert-colors</v-icon></v-btn></template>        <v-list>            <v-list-item @click="type='trend'">曲线图</v-list-item><v-list-item @click="type='bar'">柱形图</v-list-item>            <v-divider></v-divider>            <v-list-item @click="d_attr.tbcolor='cyan'">默认</v-list-item>            <v-list-item @click="d_attr.tbcolor='#1565C0'">蓝色</v-list-item>            <v-list-item @click="d_attr.tbcolor='#E53935'">红色</v-list-item>            <v-list-item @click="d_attr.tbcolor='#EF6C00'">橙色</v-list-item>				<v-list-item @click="d_attr.tbcolor='#37474F'">灰色</v-list-item>				<v-list-item @click="d_attr.tbcolor='#6D4C41'">棕色</v-list-item>				<v-list-item @click="d_attr.tbcolor='#2E7D32'">绿色</v-list-item>        </v-list>        </v-menu>        <v-menu bottom left>        <template v-slot:activator="{ on }"><v-btn icon  v-on="on" ><v-icon>mdi-dots-vertical</v-icon></v-btn></template>        <v-list>          <v-list-item @click="newItem()"><v-list-item-title>新增数据</v-list-item-title></v-list-item>          <v-divider></v-divider>           <v-list-item @click="init()">刷新数据</v-list-item-title></v-list-item>        </v-list>        </v-menu> </v-toolbar>   <v-data-table   :headers="headers" :items="d_items" class="elevation-1"  mobile-breakpoint="200" hide-default-footer dense>    <template v-slot:top><!-- 编辑的对话框-->      <v-dialog v-model="EditDialog" max-width="350" persistent >        <v-card><!-- dialog按钮---------- --><v-card-title class="headline" style="background:#F1FAFA">	<v-btn rounded color="primary" dark @click="close()" small><v-icon>mdi-keyboard-return</v-icon>返回</v-btn><v-spacer></v-spacer>	<v-btn v-if="(editedIndex>-1)&&editable" rounded small color="primary" dark @click="deleteItem(d_items[editedIndex]);"><v-icon>mdi-delete</v-icon>删除</v-btn><v-spacer></v-spacer>	 	<v-btn v-if="crudToolbar==false"  rounded color="primary" dark @click="close()" small><v-icon>mdi-keyboard-return</v-icon>返回</v-btn>	<v-btn v-else-if="editable" rounded color="primary" dark @click="saveData()" small><v-icon>mdi-alert-circle</v-icon>保存[{{editedItem.ID}}]</v-btn>	<v-btn v-else               rounded color="primary" dark @click="editable=true" small><v-icon>mdi-alert-circle</v-icon>开始编辑</v-btn></v-card-title>        <v-card-text>          <v-container>            <v-row>	          <v-text-field v-model="editedItem.C1" label="序号"></v-text-field><br>            <v-text-field v-model="editedItem.C2" label="名称"></v-text-field><br>            <v-text-field v-model="editedItem.C3" label="数量" type="number"></v-text-field><br>            </v-row>          </v-container>        </v-card-text>        </v-card>      </v-dialog><!-- 编辑的对话框-->    </template><template v-slot:item.action="{item }"><v-icon small  @click="editItem(item)"  color="primary" >mdi-lead-pencil</v-icon></template>    <template v-slot:no-data>    <v-btn color="primary" @click="init">刷新</v-btn>    </template></v-data-table>  </v-card></div></template><script>const gradients=[['#222'],['#42b3f4'],['red','orange','yellow'],['purple','violet'],['#00c6ff','#F0F','#FF0'],['#f72047','#ffd200','#1feaea'],]module.exports={data(){return {    EditDialog: false,    editable:true,	d_ID:0,	d_attr:{tbcolor:'primary',title:'spark简易图：'},	url_r:'/common/data_r.asp',	url_s:'/common/data_s.asp',	url_d:'/common/data_d.asp',	test_data:'test_data.html',    d_items: [],    editedIndex: -1,    editedItem:  {C1:'',C2:'',C3: 0},    defaultItem: {C1:'',C2:'',C3: 0},    headers:[{text:'编号',value:'C1'},{text:'名称',value:'C2'},{text:'数量',value:'C3'},{text:'',value:'action',sortable:false },],    //sparkline------------    lineWidth: 2,    labelSize: 10,    radius: 8,    padding: 8,    lineCap: 'round',    gradient:['white'],    value:[],    labels:[],    gradientDirection: 'top',    gradients,    fill: false,    type: 'trend',    autoLineWidth: false,    }},    computed: {    formTitle(){return this.editedIndex === -1 ? '新增记录：' : '修改数据：'    },    chartdata(){this.value=[];this.labels=[]; //for (var i=0;i<this.d_items.length;i++) { this.value.push(this.d_items[i].C3);}    			this.d_items.forEach(v=>{this.value.push(parseFloat(v.C3));this.labels.push(v.C2);});    			this.gradient=[this.d_attr.tbcolor];    			return '';},    }, // computed:    watch: {    dialog (val) {val || this.close() },    },created(){this.init();	 app.tabobj[app.tabobj.length -1]=this ;},    methods: {	afterData(){app.ShowSnack('图表数据加载完成！')},	 	editItem(item){ app.editItem(this,item);this.EditDialog=true;}, //编辑	newItem() { app.newItem(this); this.EditDialog=true;},	deleteItem(item){this.EditDialog=false; app.deleteItem(this,item);},	saveData() {this.EditDialog=false; app.saveData(this);}, //保存	close(){this.EditDialog = false;},	init(){if(gv_db!=''){app.getData(this);}else{app.getTestData(this);}},//init    },  }</script><style>  .v-sheet--offset{top: -40px; position:relative;}</style>